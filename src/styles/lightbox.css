
.md-lightbox-dialog::backdrop,
.lightbox-dialog::backdrop { background: rgba(0,0,0,0.85); }

/* 恢复 util/Lightbox 内容区的网格居中对齐 */
.lightbox-dialog .lightbox-content {
  display: grid;
  place-items: center;
  width: 100%;
  height: 100%;
  background: transparent;
}

/* 确保图片容器双向居中（util/Lightbox 与 md 灯箱一致） */
.lightbox-dialog .lightbox-image-container,
.md-lightbox-dialog .lightbox-image-container {
  display: flex;
  justify-content: center;
  align-items: center;
  width: 100%;
  height: 100%;
}

/* 所有图片保持水平居中 */
.md-lightbox-dialog img,
.lightbox-dialog .lightbox-image,
#md-lightbox-img {
  max-width: 90vw;
  max-height: 90vh;
  object-fit: contain;
  display: block;
  margin-left: auto;
  margin-right: auto;
}

/* 关闭按钮：统一使用变量定位，避免固定高度 */
.md-lightbox-dialog button,
.lightbox-dialog .close-button {
  position: absolute;
  top: calc(var(--lb-img-top, 3vh) - var(--lb-btn-offset, 1rem)) !important;
  right: 0.75rem;
  left: auto;
  transform: none;
  font-size: 1.75rem;
  color: #fff;
  background: none;
  border: none;
  cursor: pointer;
}


/* 打开灯箱时禁用滚动 */
html.lightbox-open, html.lightbox-open body {
  overflow: hidden !important;
  overscroll-behavior: none;
  touch-action: none;
}

/* Markdown 灯箱图片的中心对齐辅助 */
#md-lightbox-img {
  display: block;
  margin: 0 auto;
}

/* 移动端优化：栈布局、图片更靠中心、文案回到流内 */
@media (max-width: 768px) {
  .md-lightbox-dialog[open],
  .lightbox-dialog[open] {
    padding: 0.5rem 0.75rem;
    gap: 0.5rem;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    overflow: hidden;
  }
  .md-lightbox-dialog img,
  .lightbox-dialog .lightbox-image,
  #md-lightbox-img {
    max-width: 100%;
    width: auto;
    height: auto;
    max-height: calc(100dvh - 7rem);
    object-fit: contain;
    display: block;
    margin: 0 auto !important;
    box-sizing: border-box;
  }
  .md-lightbox-dialog p,
  .lightbox-dialog .lightbox-caption {
    position: static;
    transform: none;
    width: 100%;
    margin: 0;
    padding: 0 0.5rem;
    text-align: center;
    box-sizing: border-box;
  }
  .md-lightbox-dialog button,
  .lightbox-dialog .close-button {
    /* 描述跟随内容流：显示在图片下方居中 */
    #md-lightbox-caption {
      position: static !important;
      left: auto !important;
      right: auto !important;
      bottom: auto !important;
      transform: none !important;
      width: 100% !important;
      margin: 0.25rem 0 0 !important;
      padding: 0 0.5rem !important;
      text-align: center !important;
      color: #fff !important;
    }
    
    /* 关闭按钮贴近图片右上角，并确保可点击 */
    /* 让图片容器成为定位上下文 */
    .md-lightbox-dialog .lightbox-image-container {
      position: relative !important;
    }
    
    /* 关闭按钮：相对图片容器右上角（不依赖 --lb-img-top） */
    #md-lightbox-close {
      position: absolute !important;
      top: -0.5rem !important;
      right: -0.5rem !important;
      z-index: 2147483648 !important;
      pointer-events: auto !important;
      touch-action: manipulation !important;
      -webkit-tap-highlight-color: transparent;
    }
    
    /* 对话框采用纵向布局，让图片在上、描述在下 */
    .md-lightbox-dialog[open] {
      flex-direction: column !important;
      gap: 0.5rem !important;
    }
    font-size: 1.75rem;
  }
}
