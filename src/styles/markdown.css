@import "tailwindcss";
@plugin "@tailwindcss/typography";

/*
  ==========================================================================
  Markdown 全局样式定制 (最终清理版)
  ==========================================================================
  说明：
  - 此文件用于覆盖和扩展 @tailwindcss/typography 插件的默认样式。
  - 标题和链接的颜色已在 tailwind.config.mjs 中通过 CSS 变量全局设置，
    此处不再定义任何颜色相关的样式，以避免冲突。
*/

/*
  移动端基础字体大小调整
  ==========================================================================
*/
.prose {
  @apply text-base; /* 默认大小 */
}

@media (max-width: 768px) {
  .prose {
    @apply text-sm; /* 移动端调小 */
  }
  
  /* 移动端段落缩进调整 */
  .prose p {
    text-indent: 1.5em;
  }
  
  /* 移动端标题大小调整 */
  .prose h1 { @apply text-2xl; }
  .prose h2 { @apply text-xl; }
  .prose h3 { @apply text-lg; }
  .prose h4 { @apply text-base; }
  .prose h5 { @apply text-sm; }
  .prose h6 { @apply text-xs; }
}

/*
  全局链接样式美化
  ==========================================================================
*/
.prose a {
  @apply underline decoration-dashed decoration-2 decoration-black/50 transition-all duration-200 dark:decoration-white/50;
  text-underline-offset: 3px;
}

.prose a:hover {
  @apply decoration-solid decoration-black dark:decoration-white;
}
.dark .prose a {
  text-decoration-color: rgba(255, 255, 255, 0.5); /* 暗色模式: 半透明白 */
}

.dark .prose a:hover {
  text-decoration-color: white; /* 暗色模式悬停: 纯白 */
}

/*
  深色模式正文和粗体文本颜色
  ==========================================================================
*/
.dark .prose {
  color: white;
}

.dark .prose strong {
  color: white;
}

/*
  1. 标题内锚点链接样式重置
  ==========================================================================
  目标：让标题内的链接看起来就像普通标题，继承父级颜色，并移除下划线。
*/
.prose h1 a,
.prose h2 a,
.prose h3 a,
.prose h4 a,
.prose h5 a,
.prose h6 a {
  color: inherit;
  text-decoration: none;
}

/*
  2. 标题悬浮提示
  ==========================================================================
  目标：鼠标悬停在标题上时，在左侧显示其等级（H1, H2, ...）。
*/
.prose h1,
.prose h2,
.prose h3,
.prose h4,
.prose h5,
.prose h6 {
  @apply relative;
}

.prose h1::before,
.prose h2::before,
.prose h3::before,
.prose h4::before,
.prose h5::before,
.prose h6::before {
  @apply absolute right-full top-1/2 -translate-y-1/2 mr-2 text-sm font-normal text-gray-400 opacity-0 transition-opacity duration-200 dark:text-gray-500;
}

.prose h1:hover::before,
.prose h2:hover::before,
.prose h3:hover::before,
.prose h4:hover::before,
.prose h5:hover::before,
.prose h6:hover::before {
  @apply opacity-100;
}

.prose h1::before { content: 'H1'; }
.prose h2::before { content: 'H2'; }
.prose h3::before { content: 'H3'; }
.prose h4::before { content: 'H4'; }
.prose h5::before { content: 'H5'; }
.prose h6::before { content: 'H6'; }

/*
  3. 引用块 (Blockquote) 样式
  ==========================================================================
*/
.prose blockquote {
  @apply relative border-l-4 p-5 my-6 rounded-r-lg shadow-sm 
         transition-all duration-300 hover:shadow-md;
  border-left-color: hsl(var(--primary-hue), 60%, 60%);
  background-color: hsl(var(--primary-hue), 80%, 95%);
  color: hsl(var(--primary-hue), 70%, 25%);
}

/* 移动端引用块调整 */
@media (max-width: 768px) {
  .prose blockquote {
    @apply p-3 my-4 text-sm;
  }
  
  .prose blockquote::before {
    @apply -top-1 -left-1 text-4xl;
  }
}

/* 深色模式下的引用块样式 */
html.dark .prose blockquote {
  background-color: hsl(var(--primary-hue), 40%, 8%);
  color: hsl(var(--primary-hue), 60%, 80%);
  border-left-color: hsl(var(--primary-hue), 50%, 50%);
}

/* 装饰性引用符号 */
.prose blockquote::before {
  content: '"';
  @apply absolute -top-2 -left-2 text-5xl opacity-30;
  color: hsl(var(--primary-hue), 50%, 60%);
}

html.dark .prose blockquote::before {
  color: hsl(var(--primary-hue), 40%, 40%);
}

.prose blockquote p:first-of-type::before {
  content: none;
}

.prose blockquote p {
  @apply m-0 pl-2 relative z-10;
}

/* 引用来源样式 */
.prose blockquote cite {
  @apply block mt-3 text-sm text-blue-600 italic
         dark:text-blue-400;
}

/* 移动端引用来源调整 */
@media (max-width: 768px) {
  .prose blockquote cite {
    @apply mt-2 text-xs;
  }
}

/*
  4. 段落与列表样式
  ==========================================================================
*/
.prose p {
  @apply [text-indent:2em];
}

.prose li > p,
.prose blockquote p {
  @apply [text-indent:0];
}

/* 移动端列表调整 */
@media (max-width: 768px) {
  .prose ul, .prose ol {
    @apply pl-4;
  }
  
  .prose li {
    @apply text-sm;
  }
}

/*
  5. 媒体与代码块样式
  ==========================================================================
*/
.prose img {
  @apply rounded-lg shadow-md;
}

.prose pre {
  @apply bg-gray-800 text-gray-100 rounded-lg shadow-lg;
}

/* 移动端代码块调整 */
@media (max-width: 768px) {
  .prose pre {
    @apply text-xs p-3;
  }
  
  .prose code {
    @apply text-xs;
  }
  
  /* 行内代码调整 */
  .prose :not(pre) > code {
    @apply text-xs px-1 py-0.5;
  }
}

/* 表格移动端调整 */
@media (max-width: 768px) {
  .prose table {
    @apply text-xs;
  }
  
  .prose th, .prose td {
    @apply px-2 py-1;
  }
}
